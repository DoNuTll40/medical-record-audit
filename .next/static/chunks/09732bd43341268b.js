(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,e=>{"use strict";e.s(["ArrowLeft",()=>t],71689);let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},94351,e=>{"use strict";e.s(["Home",()=>t],94351);let t=(0,e.i(75254).default)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]])},78972,e=>{"use strict";e.s(["default",()=>u],78972);var t=e.i(43476),a=e.i(71645),l=e.i(46932),r=e.i(22016),n=e.i(51737),i=e.i(71689),s=e.i(94351);let d=(0,e.i(75254).default)("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]);var o=e.i(18566),c=e.i(27682);function u(){let e=(0,o.usePathname)(),[u,m]=(0,a.useState)(!1),p=new c.default;return(0,a.useEffect)(()=>m(!0),[]),(0,t.jsx)("div",{className:"w-full flex items-center justify-center px-4 select-none",children:(0,t.jsxs)(l.motion.div,{initial:{opacity:0,y:8,scale:.98},animate:{opacity:+!!u,y:0,scale:1},transition:{duration:.2},className:"w-full max-w-3xl rounded-2xl border bg-[#F9F9F9] dark:bg-zinc-900/60 p-6 shadow-xl   backdrop-blur border-black/10 dark:border-zinc-800/60   text-zinc-800 dark:text-zinc-200",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"rounded-xl bg-red-500/10 p-2.5 ring-1 ring-inset ring-red-500/30",children:(0,t.jsx)(n.ShieldAlert,{className:"size-6 text-red-400"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h1",{className:"text-xl font-bold",children:"ไม่มีสิทธิ์เข้าถึง (403)"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-zinc-800 dark:text-zinc-400",children:"คุณไม่ได้รับอนุญาตให้เข้าถึงทรัพยากรนี้ โปรดตรวจสอบสิทธิ์การใช้งานกับผู้ดูแลระบบ"})]})]}),(0,t.jsxs)("div",{className:"mt-6 grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-black/10 dark:border-zinc-800/60 bg-[#e3e3e3] dark:bg-zinc-900 p-4",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-zinc-700 dark:text-zinc-300 mb-2",children:"ตัวเลือกที่แนะนำ"}),(0,t.jsxs)("ol",{className:"space-y-2 text-sm text-zinc-400",children:[(0,t.jsxs)("li",{className:"flex items-center gap-2",children:[(0,t.jsx)("kbd",{className:"px-1.5 py-0.5 rounded bg-zinc-800 text-zinc-200 text-xs border border-zinc-700",children:"Alt"}),(0,t.jsx)("span",{className:"text-zinc-500",children:"+"}),(0,t.jsx)("kbd",{className:"px-1.5 py-0.5 rounded bg-zinc-800 text-zinc-200 text-xs border border-zinc-700",children:"←"}),(0,t.jsx)("span",{className:"ml-2 text-zinc-700 dark:text-zinc-300",children:"กลับหน้าก่อนหน้า"})]}),(0,t.jsxs)("li",{className:"flex items-center gap-2",children:[(0,t.jsx)("kbd",{className:"px-1.5 py-0.5 rounded bg-zinc-800 text-zinc-200 text-xs border border-zinc-700",children:"Ctrl"}),(0,t.jsx)("span",{className:"text-zinc-500",children:"+"}),(0,t.jsx)("kbd",{className:"px-1.5 py-0.5 rounded bg-zinc-800 text-zinc-200 text-xs border border-zinc-700",children:"R"}),(0,t.jsx)("span",{className:"ml-2 text-zinc-700 dark:text-zinc-300",children:"รีเฟรชและลองใหม่"})]})]})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-black/10 dark:border-zinc-800/60 bg-[#e3e3e3] dark:bg-zinc-900 p-4",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-zinc-700 dark:text-zinc-300 mb-2",children:"ข้อมูลเพิ่มเติม"}),(0,t.jsxs)("div",{className:"text-sm text-zinc-400",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-zinc-700 dark:text-zinc-400",children:"URL"}),(0,t.jsx)("span",{className:"truncate max-w-[60%] text-zinc-700 dark:text-zinc-300",children:e})]}),(0,t.jsxs)("div",{className:"mt-1 flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-zinc-700 dark:text-zinc-400",children:"สถานะ"}),(0,t.jsx)("span",{className:"text-zinc-700 dark:text-zinc-300",children:"403 Forbidden"})]})]})]})]}),(0,t.jsxs)("div",{className:"mt-6 flex flex-wrap gap-3",children:[(0,t.jsxs)(l.motion.div,{whileTap:{scale:.98},onClick:()=>{window.history.length>1?window.history.back():window.location.replace("/auth/login")},onMouseDown:e=>p.create(e),className:"inline-flex items-center gap-2 rounded-lg bg-zinc-200 px-4 py-2 font-semibold text-zinc-900   hover:bg-zinc-100 active:scale-[0.98] transition cursor-pointer   dark:bg-zinc-800 dark:text-zinc-100 dark:hover:bg-zinc-700",children:[(0,t.jsx)(i.ArrowLeft,{className:"size-4"}),"กลับหน้าก่อนหน้า"]}),(0,t.jsxs)(r.default,{draggable:!1,href:"/",prefetch:!1,replace:!0,className:"inline-flex items-center gap-2 rounded-lg bg-emerald-500 dark:bg-emerald-600 px-4 py-2 font-semibold text-white   hover:bg-emerald-400 dark:hover:bg-emerald-500 active:scale-[0.98] transition",children:[(0,t.jsx)(s.Home,{className:"size-4"}),"ไปหน้า Dashboard"]}),(0,t.jsxs)(r.default,{draggable:!1,href:"/auth/login",prefetch:!1,replace:!0,className:"inline-flex items-center gap-2 rounded-lg border border-zinc-700 px-4 py-2 font-semibold   text-zinc-900 hover:bg-zinc-200 dark:text-zinc-200 dark:hover:bg-zinc-800/60 active:scale-[0.98] transition",children:[(0,t.jsx)(d,{className:"size-4"}),"เข้าสู่ระบบ"]})]})]})})}},15862,e=>{"use strict";e.s(["useFormReset",()=>l]);var t=e.i(71645),a="undefined"!=typeof document?t.default.useLayoutEffect:()=>{};function l(e,l,r){let n=(0,t.useRef)(l),i=function(e){let l=(0,t.useRef)(null);return a(()=>{l.current=e},[e]),(0,t.useCallback)(function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];let r=l.current;return null==r?void 0:r(...t)},[])}(()=>{r&&r(n.current)});(0,t.useEffect)(()=>{var t;let a=null==(t=null==e?void 0:e.current)?void 0:t.form;return null==a||a.addEventListener("reset",i),()=>{null==a||a.removeEventListener("reset",i)}},[e,i])}},93334,e=>{"use strict";e.s(["default",()=>x],93334);var t=e.i(43476),a=e.i(71645),l=e.i(46932),r=e.i(27682),n=e.i(75935);let i=(0,e.i(75254).default)("list-minus",[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 19H3",key:"zzsher"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]);var s=e.i(56909),d=e.i(37727),o=e.i(212),c=e.i(56124),u=e.i(76220),m=e.i(84735),p=e.i(52315);function x(e){let{isOpen:x,onClose:h,onSubmit:f,loading:b=!1,title:g="ฟอร์ม",submitLabel:v="บันทึก",editData:_=null,fields:y=[],delModal:k=!1}=e,[w,j]=(0,a.useState)({}),N=new r.default;function z(e,t){let a={};for(let r of e){let e=null==t?void 0:t[r.name];if("checkbox"===r.type)a[r.name]="boolean"==typeof e?e:"boolean"==typeof r.defaultValue&&r.defaultValue;else if("checkbox-group"===r.type)a[r.name]=Array.isArray(e)?e:Array.isArray(r.defaultValue)?r.defaultValue:[];else{var l;a[r.name]=(null!=(l=null!=e?e:r.defaultValue)?l:"")+""}}return a}if((0,a.useEffect)(()=>{x&&j(z(y,_))},[x,_,y]),!x)return null;let C=!!_,S=()=>{j(z(y,null)),null==h||h()};return(0,t.jsx)(l.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 flex items-center justify-center bg-black/20 backdrop-blur-sm px-4",onMouseDown:e=>{e.target===e.currentTarget&&S()},children:(0,t.jsxs)(l.motion.form,{initial:{opacity:0,scale:.9,y:40},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:40},transition:{duration:.2,ease:"easeOut"},onSubmit:e=>{e.preventDefault(),f(w)},className:"bg-white dark:bg-[#181818] w-full max-w-lg rounded-2xl shadow-xl border border-zinc-200 dark:border-zinc-700",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center border-b border-zinc-200 dark:border-zinc-700 px-4 py-2",children:[(0,t.jsxs)("h2",{className:"text-md font-semibold text-zinc-900 dark:text-zinc-100 flex gap-1 items-center",children:[k?(0,t.jsx)(i,{className:"w-5 h-5"}):(0,t.jsx)(n.ListFilterPlus,{className:"w-5 h-5"}),k?"ลบข้อมูล ".concat(g):C?"แก้ไข ".concat(g):"เพิ่ม ".concat(g)]}),(0,t.jsx)(l.motion.button,{type:"button",whileTap:{scale:.98},onClick:S,onMouseUp:e=>N.create(e),className:"p-1.5 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 cursor-pointer",children:(0,t.jsx)(d.X,{className:"w-5 h-5 text-zinc-600 dark:text-zinc-400"})})]}),(0,t.jsx)("div",{className:"flex flex-col gap-3 max-h-[60vh] overflow-y-auto px-6 py-4",children:y.map(e=>{var a,l,r,n,i,s,d,x,h;let f;if("select"===e.type){let i;return(0,t.jsx)(c.Select,{selectionMode:"single",selectedKeys:w[e.name]?new Set([String(w[e.name])]):new Set,onSelectionChange:(i=e.name,e=>{var t;let a=null!=(t=Array.from(e)[0])?t:"";j(e=>({...e,[i]:a}))}),disableSelectorIconRotation:!0,className:null!=(a=e.className)?a:"w-full mt-2",radius:null!=(l=e.radius)?l:"sm",labelPlacement:"outside",placeholder:null!=(r=e.placeholder)?r:"โปรดเลือก",isRequired:!!e.required,label:e.label,isDisabled:!!e.disableWhenEdit&&C,children:(null!=(n=e.options)?n:[]).map(e=>(0,t.jsx)(u.SelectItem,{children:e.label},String(e.key)))},e.name)}if("checkbox-group"===e.type){let a;return(0,t.jsx)(p.CheckboxGroup,{label:e.label,value:Array.isArray(w[e.name])?w[e.name]:[],onValueChange:(a=e.name,e=>{j(t=>({...t,[a]:Array.isArray(e)?e:[]}))}),isRequired:!!e.required,isDisabled:!!e.disableWhenEdit&&C,className:e.className,children:(null!=(i=e.options)?i:[]).map(e=>(0,t.jsx)(m.Checkbox,{value:String(e.key),children:e.label},String(e.key)))},e.name)}if("checkbox"===e.type){let a;return(0,t.jsx)(m.Checkbox,{isSelected:!!w[e.name],onValueChange:(a=e.name,e=>{j(t=>({...t,[a]:!!e}))}),isDisabled:!!e.disableWhenEdit&&C,className:e.className,children:null!=(s=e.label)?s:e.name},e.name)}return(0,t.jsx)(o.Input,{type:"password"===e.type?"password":"text",radius:null!=(d=e.radius)?d:"sm",isRequired:!!e.required,label:e.label,labelPlacement:"outside-top",placeholder:null!=(x=e.placeholder)?x:"",value:null!=(h=w[e.name])?h:"",onValueChange:(f=e.name,e=>{j(t=>({...t,[f]:e}))}),className:e.className},e.name)})}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 border-t border-zinc-200 dark:border-zinc-700 px-4 py-2",children:[(0,t.jsx)(l.motion.button,{type:"button",whileTap:{scale:.98},onClick:S,onMouseUp:e=>N.create(e,"dark"),className:"cursor-pointer px-6 py-1.5 rounded-xl text-sm bg-zinc-200 hover:bg-zinc-300 dark:bg-zinc-700 dark:hover:bg-zinc-600 text-zinc-800 dark:text-zinc-100",children:"ยกเลิก"}),(0,t.jsxs)(l.motion.button,{whileTap:{scale:.98},type:"submit",className:"flex items-center gap-0.5 cursor-pointer px-8 py-1.5 rounded-xl text-sm bg-emerald-600 hover:bg-emerald-500 text-white disabled:opacity-50 disabled:cursor-not-allowed",onMouseUp:e=>N.create(e,"dark"),disabled:b,children:[(0,t.jsx)(s.Save,{size:17,strokeWidth:1.5}),b?"กำลังบันทึก...":v||(C?"บันทึกการแก้ไข":"บันทึก")]})]})]})})}},22610,e=>{"use strict";e.s(["default",()=>z],22610);var t=e.i(43476),a=e.i(71645),l=e.i(51497),r=e.i(15879),n=e.i(20545),i=e.i(212),s=e.i(78502),d=e.i(63178),o=e.i(63097),c=e.i(27682),u=e.i(66540),m=e.i(46932),p=e.i(84735),x=e.i(33729),h=e.i(45800),f=e.i(63790),b=e.i(74780),g=e.i(36132),v=e.i(93334),_=e.i(30024),y=e.i(78972),k=e.i(24062),w=e.i(22016);let j=(0,e.i(75254).default)("code-xml",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]);function N(e){let{title:a="กำลังพัฒนา",message:l="ฟีเจอร์นี้ยังไม่พร้อมให้ใช้งานตอนนี้",subMessage:r="ทีมงานกำลังเร่งทำให้เสร็จแบบโดยเร็วที่สุด",progress:n,est:i,actions:s=[],className:d=""}=e,o=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")},u=new c.default;return(0,t.jsxs)(m.motion.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},"aria-live":"polite",className:o("w-full rounded-2xl border border-neutral-200 dark:border-neutral-800 bg-white/70 dark:bg-neutral-900/70","backdrop-blur p-4 shadow-sm",d),children:[(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"h-12 w-12 shrink-0 rounded-xl border border-neutral-200 dark:border-neutral-800    bg-gradient-to-br from-emerald-100 to-emerald-200 dark:from-emerald-900/40 dark:to-emerald-800/30   flex items-center justify-center","aria-hidden":!0,children:(0,t.jsx)(j,{className:"size-6 text-emerald-700 dark:text-emerald-400"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("h2",{className:"text-lg sm:text-xl font-semibold tracking-tight text-neutral-900 dark:text-neutral-50",children:a}),(0,t.jsx)("p",{className:"mt-1 text-base font-medium text-neutral-700 dark:text-neutral-300",children:l}),(0,t.jsx)("p",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:r})]})]}),("number"==typeof n||i)&&(0,t.jsxs)("div",{className:"mt-6 space-y-2",children:["number"==typeof n&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-neutral-500 dark:text-neutral-400",children:[(0,t.jsx)("span",{children:"ความคืบหน้า"}),(0,t.jsxs)("span",{"aria-live":"polite",children:[(0,t.jsx)("span",{className:"font-medium",children:Math.max(0,Math.min(100,n))}),"%"]})]}),(0,t.jsx)("div",{className:"h-2 w-full rounded-full bg-neutral-200 dark:bg-neutral-800 overflow-hidden",children:(0,t.jsx)("div",{className:"h-full rounded-full bg-emerald-600 dark:bg-emerald-400 transition-[width] duration-500",style:{width:"".concat(Math.max(0,Math.min(100,n)),"%")},role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":Math.max(0,Math.min(100,n))})})]}),i&&(0,t.jsx)("p",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:i})]}),s.length>0&&(0,t.jsx)("div",{className:"mt-6 flex flex-wrap gap-2",children:s.map((e,a)=>{let l=o("inline-flex items-center gap-2 rounded-lg px-3 py-2 text-sm transition border focus:outline-none focus:ring-2 focus:ring-emerald-400/60",e.primary?"bg-emerald-600 text-white border-emerald-600 hover:bg-emerald-700":"bg-transparent text-neutral-700 dark:text-neutral-200 border-neutral-300 dark:border-neutral-700 hover:bg-neutral-50 dark:hover:bg-neutral-800/60 cursor-pointer"),r=(0,t.jsx)("span",{className:"whitespace-nowrap",children:e.label});return e.href?(0,t.jsx)(w.default,{draggable:!1,href:e.href,className:l,onMouseDown:e=>u.create(e,"dark"),rel:"noreferrer",children:r},a):(0,t.jsx)("button",{type:"button",onClick:e.onClick,onMouseDown:e=>u.create(e,"light"),className:l,children:r},a)})})]})}function z(){var e;let{profile:w,authLoading:j}=(0,r.default)(),{setAutoSaveMessage:z}=(0,k.default)(),{resolvedTheme:C}=(0,d.useTheme)(),[S,D]=(0,a.useState)(localStorage.getItem("token")),[I,A]=(0,a.useState)(!1),[E,T]=(0,a.useState)(""),[M,R]=(0,a.useState)({hcode:"",hcode_name:""}),[P,V]=(0,a.useState)([]),[F,X]=(0,a.useState)([]),[W,B]=(0,a.useState)(null),[L,H]=(0,a.useState)(""),[O,q]=(0,a.useState)(!1),[Y,U]=(0,a.useState)(!1),[G,K]=(0,a.useState)(!1),[J,Q]=(0,a.useState)({content:[],overall:[],review_status_id:null,review_status_result:null,review_status_comment:""}),[Z,$]=(0,a.useState)(null),[ee,et]=(0,a.useState)(!1),[ea,el]=(0,a.useState)(!1),[er,en]=(0,a.useState)(!1),[ei,es]=(0,a.useState)(null),ed=(0,a.useRef)(),eo=(0,a.useRef)(null),ec=new c.default;if((0,a.useEffect)(()=>A(!0),[]),(0,a.useEffect)(()=>{try{D(localStorage.getItem("token"))}catch(e){}},[]),!S)return(0,t.jsx)(y.default,{});if(null===S)return(0,t.jsx)(l.default,{});if((null==w?void 0:w.email)==="iinter731@gmail.com")return(0,t.jsx)(N,{title:"แบบประเมินคุณภาพการบันทึกเวชระเบียนผู้ป่วยนอก/ฉุกเฉิน (OPD/ER)",message:"ระบบกำลังอยู่ในระหว่างการพัฒนา",subMessage:"ขออภัยในความไม่สะดวกครับ/ค่ะ",progress:20,est:"ETA : คาดว่าจะเสร็จภายในสัปดาห์นี้",actions:[{label:"กลับไปหน้า Dashboard",href:"/",primary:!0},{label:"รีเฟรช",onClick:()=>location.reload()}]});let eu=(0,a.useCallback)(e=>{e.api.sizeColumnsToFit()},[]),em=async()=>{let e=localStorage.getItem("token");try{let t=await n.default.get("/setting/hcode",{headers:{Authorization:"Bearer ".concat(e)}});200===t.status&&R(t.data.data[0])}catch(e){console.log(e)}},ep=async e=>{en(!1);try{let t=await n.default.get("mraIpd/fetchPatient/".concat(e),{headers:{Authorization:"Bearer ".concat(S)}});200===t.status&&($(t.data.data),await ex(e),(0,g.addToast)({title:"สําเร็จ",description:t.data.message,timeout:8e3,color:"success",shouldShowTimeoutProgress:!0}))}catch(a){var t;if(console.log(a),(null==a||null==(t=a.response)?void 0:t.status)===409)return void await ex(e);(0,g.addToast)({title:"เกิดข้อผิดพลาด",description:a.response.data.message,timeout:8e3,color:"danger",shouldShowTimeoutProgress:!0})}};(0,o.useIdleTimer)({timeout:1e3,onIdle:()=>{(null==E?void 0:E.trim())&&ep(E)},events:["keyup"],element:eo.current,immediateEvents:[]});let ex=async e=>{U(!0);try{let a=await n.default.post("/mraIpd",{patient_an:e},{headers:{Authorization:"Bearer ".concat(S)}});if(200===a.status){var t;(0,g.addToast)({title:"สําเร็จ",description:a.data.message,timeout:8e3,color:"success",shouldShowTimeoutProgress:!0});let e=a.data.data;V(e[0].form_ipd_content_of_medical_record_results),X(e[0].form_ipd_overall_finding_results),eh();let l=(Array.isArray(e)?null==(t=e[0])?void 0:t.patients:null==e?void 0:e.patients)||{};$({an:l.patient_an||"",hn:l.patient_hn||"",fullname:l.patient_fullname||"",regdate:l.patient_date_admitted||"",dcgdate:l.patient_date_discharged||"",ward_name:l.patient_ward||""}),Q(t=>({...t,content:e[0].form_ipd_content_of_medical_record_results.map(e=>{let{created_at:t,updated_at:a,created_by:l,updated_by:r,total_score:n,content_of_medical_records:i,...s}=e,d={content_of_medical_record_id:null==i?void 0:i.content_of_medical_record_id};for(let e in s){let t=s[e];"comment"===e?d[e]=null!=t?t:null:"na"===e||"missing"===e||"no"===e?d[e]=!!t:d[e]="boolean"==typeof t?+!!t:null==t?0:t}return d})}))}}catch(e){console.log(e),409===e.response.status?ef():(0,g.addToast)({title:"เกิดข้อผิดพลาด",description:e.response.data.message,timeout:8e3,color:"danger",shouldShowTimeoutProgress:!0})}finally{U(!1)}};(0,a.useEffect)(()=>{em(),eo.current.focus()},[j,S,w]);let eh=async()=>{try{let e=await n.default.get("/mraIpd/rvst",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});200===e.status&&B(e.data.data)}catch(e){console.log(e)}},ef=async()=>{var e,t,a,l,r;el(!0);try{let t=await n.default.get("/mraIpd/".concat(E),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),a=t.data.data[0];if(200===t.status){en(!0),es(a);let t=(Array.isArray(a)?null==(e=a[0])?void 0:e.patients:null==a?void 0:a.patients)||{};$({an:t.patient_an||"",hn:t.patient_hn||"",fullname:t.patient_fullname||"",regdate:t.patient_date_admitted||"",dcgdate:t.patient_date_discharged||"",ward_name:t.patient_ward||""}),setTimeout(()=>{ed.current&&ed.current.focus()},500)}}catch(e){if(409===e.response.status){en(!0),H(null==(a=e.response)||null==(t=a.data.data)?void 0:t.pdf_ipd_file);let n=null==(r=e.response.data.data)||null==(l=r.form_ipds)?void 0:l.patients;$({hn:n.patient_hn||"",fullname:n.patient_fullname||"",regdate:n.patient_date_admitted||"",dcgdate:n.patient_date_discharged||"",ward_name:n.patient_ward||""})}else(0,g.addToast)({title:"เกิดข้อผิดพลาด",description:e.response.data.message,timeout:8e3,color:"danger",shouldShowTimeoutProgress:!0})}finally{el(!1)}},eb=(e,t)=>"na"===t?(null==e?void 0:e.missing)||(null==e?void 0:e.no):"missing"===t?(null==e?void 0:e.na)||(null==e?void 0:e.no):"no"===t?(null==e?void 0:e.na)||(null==e?void 0:e.missing):(null==e?void 0:e.na)||(null==e?void 0:e.missing)||(null==e?void 0:e.no),eg=[{field:"content_of_medical_record_name",pinned:"left",headerName:"หัวข้อเวชระเบียน",valueGetter:e=>{var t;let a=e.node.rowIndex+1,l=(null==(t=e.data.content_of_medical_records)?void 0:t.content_of_medical_record_name)||"";return"".concat(a,".").concat(l)},minWidth:240},{field:"na",editable:e=>{var t;return!eb(e.data,"na")&&(null==(t=e.data.content_of_medical_records)?void 0:t.na_type)!==!1},headerName:"NA",minWidth:60,cellRenderer:"agCheckboxCellRenderer",cellEditor:"agCheckboxCellEditor",cellStyle:e=>{var t;return eb(e.data,"na")||(null==(t=e.data.content_of_medical_records)?void 0:t.na_type)===!1?{backgroundColor:I&&"dark"===C?"#303030":"#D7D7D7",cursor:"not-allowed",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center"}:{display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}}},{field:"missing",headerName:"Missing",minWidth:80,cellRenderer:"agCheckboxCellRenderer",cellEditor:"agCheckboxCellEditor",editable:e=>{var t;return!eb(e.data,"missing")&&(null==(t=e.data.content_of_medical_records)?void 0:t.missing_type)!==!1},cellStyle:e=>{var t;return eb(e.data,"missing")||(null==(t=e.data.content_of_medical_records)?void 0:t.missing_type)===!1?{backgroundColor:I&&"dark"===C?"#303030":"#D7D7D7",cursor:"not-allowed",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center"}:{display:"flex",alignItems:"center",justifyContent:"center"}}},{field:"no",headerName:"No",minWidth:60,cellRenderer:"agCheckboxCellRenderer",cellEditor:"agCheckboxCellEditor",cellDataType:"boolean",editable:e=>{var t;return!eb(e.data,"no")&&(null==(t=e.data.content_of_medical_records)?void 0:t.no_type)!==!1},cellStyle:e=>{var t;return eb(e.data,"no")||(null==(t=e.data.content_of_medical_records)?void 0:t.no_type)===!1?{backgroundColor:I&&"dark"===C?"#303030":"#D7D7D7",cursor:"not-allowed",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center"}:{display:"flex",alignItems:"center",justifyContent:"center"}}},...Array.from({length:9},(e,t)=>{let a="criterion_number_".concat(t+1),l="".concat(a,"_type");return{field:a,headerName:"เกณฑ์ ".concat(t+1),minWidth:80,cellRenderer:"agCheckboxCellRenderer",cellEditor:"agCheckboxCellEditor",cellDataType:"boolean",suppressClickEdit:!0,stopEditingWhenCellsLoseFocus:!0,editable:e=>{var t,r;let n=null==eb?void 0:eb(e.data,a),i=(null==(r=e.data)||null==(t=r.content_of_medical_records)?void 0:t[l])===!1;return!n&&!i},onCellClicked:e=>{var t,r;let n=null==eb?void 0:eb(e.data,a),i=(null==(r=e.data)||null==(t=r.content_of_medical_records)?void 0:t[l])===!1;if(n||i)return;let s=!e.value;e.node.setDataValue(a,s)},cellStyle:e=>{var t,r;let n=null==eb?void 0:eb(e.data,a),i=(null==(r=e.data)||null==(t=r.content_of_medical_records)?void 0:t[l])===!1;return n||i?{backgroundColor:I&&"dark"===C?"#303030":"#D7D7D7",cursor:"not-allowed",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center"}:{display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}},valueGetter:e=>{var t;return 1===(null==(t=e.data)?void 0:t[a])},valueSetter:e=>(e.data[a]=+!!e.newValue,!0)}}),{field:"point_deducted",headerName:"หักคะแนน",minWidth:90,cellRenderer:"agCheckboxCellRenderer",cellEditor:"agCheckboxCellEditor",cellDataType:"boolean",suppressClickEdit:!0,stopEditingWhenCellsLoseFocus:!0,valueGetter:e=>{var t,a;return(null==(t=e.data)?void 0:t.point_deducted)===1||(null==(a=e.data)?void 0:a.point_deducted)===!0},valueSetter:e=>(e.data.point_deducted=+!!e.newValue,!0),editable:e=>{var t;return!eb(e.data,"point_deducted")&&(null==(t=e.data.content_of_medical_records)?void 0:t.points_deducted_type)!==!1},onCellClicked:e=>{var t;eb(e.data,"point_deducted")||(null==(t=e.data.content_of_medical_records)?void 0:t.points_deducted_type)===!1||e.node.setDataValue("point_deducted",!e.value)},cellStyle:e=>{var t;return eb(e.data,"point_deducted")||(null==(t=e.data.content_of_medical_records)?void 0:t.points_deducted_type)===!1?{backgroundColor:I&&"dark"===C?"#303030":"#D7D7D7",cursor:"not-allowed",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center"}:{display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}}},{field:"comment",headerName:"หมายเหตุ",cellEditor:"agTextCellEditor",editable:!0,minWidth:220,stopEditingWhenCellsLoseFocus:!0,onCellClicked:e=>e.api.startEditingCell({rowIndex:e.rowIndex,colKey:"comment"})}],ev=async()=>{K(!0);let e=localStorage.getItem("token");try{let t=await n.default.put("/mraIpd/".concat(E),J,{headers:{Authorization:"Bearer ".concat(e)}});200===t.status&&(console.log(t.data),ep(E))}catch(e){console.log(e)}finally{K(!1)}},e_=async()=>{z({type:"info",message:"กําลังบันทึกอัตโนมัติ..."});let e=localStorage.getItem("token");try{let t=await n.default.put("/mraIpd/".concat(E),J,{headers:{Authorization:"Bearer ".concat(e)}});200===t.status&&z({type:"success",message:"บันทึกอัตโนมัติสําเร็จ"})}catch(e){console.log(e),z({type:"danger",message:"บันทึกอัตโนมัติไม่สําเร็จ"})}finally{setTimeout(()=>{z("")},5e3)}};(0,o.useIdleTimer)({timeout:2e3,onIdle:Z&&!er&&null===J.review_status_id?e_:null,events:["keydown","keyup","input","change"],element:"undefined"!=typeof document?document:null,immediateEvents:[],startOnMount:!1,debounce:500});let ey=()=>{Q(e=>({...e,content:[],overall:[],review_status_id:null,review_status_result:null,review_status_comment:""}))},ek=async e=>{let a=await (0,b.pdf)((0,t.jsx)(f.default,{...e})).toBlob();return await ej(a)};(0,a.useEffect)(()=>{ei&&(async()=>{let e=await ek(ei);H(e),ew(e,ei.form_ipd_id)})()},[ei]);let ew=async(e,t)=>{let a={form_ipd_id:t,binary:e,total_score:ei.totalDefaultSum,score_obtained:ei.totalScoreSum,percentage:ei.formattedResultSum};try{let e=await n.default.post("/mraIpd/insertPdf",a,{headers:{Authorization:"Bearer ".concat(S)}});200===e.status&&console.log(e.data)}catch(e){console.log(e)}},ej=e=>new Promise((t,a)=>{let l=new FileReader;l.onloadend=()=>t(l.result.split(",")[1]),l.onerror=a,l.readAsDataURL(e)}),eN=async e=>{if(q(!0),e.patient_an!==E)return(0,g.addToast)({title:"เกิดข้อผิดพลาด",description:"หมายเลข AN ไม่ถูกต้อง",timeout:8e3,color:"danger",shouldShowTimeoutProgress:!0});let t={password:e.password};try{let a=await n.default.delete("/mraIpd/".concat(e.patient_an),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},data:t});200===a.status&&((0,g.addToast)({title:"สําเร็จ",description:a.data.message,timeout:8e3,color:"success",shouldShowTimeoutProgress:!0}),ey(),T(""),$(null),es({}),en(!1),V([]),et(!1))}catch(e){console.log(e),(0,g.addToast)({title:"เกิดข้อผิดพลาด",description:e.response.data.message,timeout:8e3,color:"danger",shouldShowTimeoutProgress:!0})}finally{q(!1)}};return(0,t.jsxs)(t.Fragment,{children:[(O||G)&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center dark:bg-black/80 bg-white/40 backdrop-blur-sm",children:(0,t.jsx)(l.default,{title:O?"กําลังลบข้อมูล...":"กําลังบันทึกข้อมูล..."})}),(0,t.jsx)(v.default,{isOpen:ee,onClose:()=>et(!1),delModal:!0,title:"คุณต้องการลบข้อมูล ".concat((0,_.default)(E,{keepStart:2,keepEnd:2})),onSubmit:eN,fields:[{type:"text",name:"patient_an",label:"กรอกหมายเลข AN",placeholder:"XXXXXXXXX",required:!0,radius:"sm"},{type:"password",name:"password",label:"กรอกรหัสผ่าน",placeholder:"**********",required:!0,radius:"sm"}]}),(0,t.jsxs)("div",{className:"select-none rounded-2xl border border-zinc-300 dark:border-[#505050] mb-4 bg-white dark:bg-[#181818] shadow-lg",children:[(0,t.jsxs)("div",{className:"flex justify-between border-b border-zinc-300 dark:border-[#505050] p-4",children:[(0,t.jsxs)("div",{className:"flex gap-1 flex-col",children:[(0,t.jsx)("p",{className:"font-medium",children:"แบบตรวจประเมินคุณภาพการบันทึกเวชระเบียนผู้ป่วยนอก/ฉุกเฉิน Medical Record Audit Form (OPD/ER)"}),(0,t.jsxs)("p",{className:"text-xs font-medium text-zinc-600 dark:text-zinc-500",children:[(0,t.jsx)("span",{className:"font-semibold mr-1",children:"เงื่อนไขการบันทึกเวชระเบียน"}),"การบันทึกคะแนน (1) กรณีที่ผ่านเกณฑ์ในแต่ละข้อ ให้ติ๊กถูก (2) กรณีที่ไม่ผ่านเกณฑ์ในแต่ละข้อ ไม่ต้องติ๊ก (3) กรณีไม่จำเป็นต้องมีบันทึก/ไม่มีข้อมูล ในเกณฑ์ข้อที่ระบุให้มี NA ได้ ให้ NA"]})]}),(null==Z?void 0:Z.ward_name)&&(0,t.jsx)("span",{className:"shrink-0 h-fit rounded-full border border-zinc-300 dark:border-zinc-700 px-3 py-1 text-xs text-zinc-700 dark:text-zinc-200 bg-zinc-50 dark:bg-zinc-900/60",children:Z.ward_name})]}),(0,t.jsxs)("div",{className:"p-4 flex flex-col gap-2",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(i.Input,{variant:"bordered",radius:"md",label:"รหัสสถานพยาบาล",size:"md",placeholder:"XXXXX",value:M?M.hcode:"",labelPlacement:"outside-top",isReadOnly:!0}),(0,t.jsx)(i.Input,{variant:"bordered",radius:"md",label:"ชื่อสถานพยาบาล",size:"md",placeholder:"โรงพยาบาล.....",value:M?M.hcode_name:"",labelPlacement:"outside-top",isReadOnly:!0})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(i.Input,{variant:"bordered",radius:"md",label:"บัตรประชาชน",size:"md",placeholder:"บัตรประชาชน",value:Z?Z.fullname:"",labelPlacement:"outside-top",isDisabled:!0}),(0,t.jsx)(i.Input,{variant:"bordered",radius:"md",label:"ชื่อ-สกุล",size:"md",placeholder:"ชื่อ-สกุล",value:Z?Z.fullname:"",labelPlacement:"outside-top",isDisabled:!0}),(0,t.jsx)(i.Input,{variant:"bordered",radius:"md",label:"HN",size:"md",placeholder:"HN",value:Z?Z.hn:"",labelPlacement:"outside-top",isDisabled:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-5 gap-2",children:[(0,t.jsx)(i.Input,{ref:eo,value:E,onChange:e=>{T(e.target.value),$(null),V([]),X([]),en(!1),es(null),ey(),H("")},variant:"bordered",radius:"md",label:"VM",size:"md",placeholder:"VN",labelPlacement:"outside-top",maxLength:9}),(0,t.jsx)(i.Input,{variant:"bordered",radius:"md",label:"วันที่เข้ารับบริการ",size:"md",placeholder:"Date admitted",value:Z?(0,u.default)(null==Z?void 0:Z.regdate).add(543,"years").format("DD/MM/YYYY"):"",labelPlacement:"outside-top",isDisabled:!0}),(0,t.jsx)(i.Input,{variant:"bordered",radius:"md",label:"วันที่สิ้นสุด",size:"md",placeholder:"Date discharged",value:Z?(0,u.default)(null==Z?void 0:Z.dchdate).add(543,"years").format("DD/MM/YYYY"):"",labelPlacement:"outside-top",isDisabled:!0}),(0,t.jsxs)("div",{className:"flex flex-col items-center w-full h-full",children:[(0,t.jsx)("div",{className:"flex items-center justify-between w-full",children:(0,t.jsx)("p",{className:"text-sm mb-2",children:"ตัวเลือก"})}),(0,t.jsx)("div",{className:"w-full items-center",children:(0,t.jsx)(m.motion.button,{onClick:()=>et(!0),disabled:!er,className:"w-full text-sm text-center text-rose-700 border-rose-700 !disabled:dark:hover:border-rose-800 border font-semibold px-6 py-2 hover:bg-red-50 !disabled:dark:hover:bg-rose-800 rounded-xl dark:bg-rose-700 dark:text-white cursor-pointer disabled:opacity-40 disabled:cursor-not-allowed",children:"ลบข้อมูล"})})]})]})]})]}),!er&&(0,t.jsx)("div",{className:"shadow-lg rounded-2xl",children:(0,t.jsx)(s.default,{columnDefs:eg,rowData:P,loading:Y,pagination:!1,onCellValueChanged:e=>{e.api.refreshCells({rowNodes:[e.node],force:!0});let t=[];e.api.forEachNode(e=>{t.push({...e.data})}),Q(e=>({...e,content:t.map(e=>{let{created_at:t,updated_at:a,created_by:l,updated_by:r,total_score:n,content_of_medical_records:i,...s}=e,d={content_of_medical_record_id:null==i?void 0:i.content_of_medical_record_id};for(let e in s){let t=s[e];"comment"===e?d[e]=null!=t?t:null:"na"===e||"missing"===e||"no"===e?d[e]=!!t:d[e]="boolean"==typeof t?+!!t:null==t?0:t}return d})}))},onGridReady:eu})}),P.length>0&&!er&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("hr",{className:"mt-8 mb-6"}),(0,t.jsx)("p",{className:"underline underline-offset-2 select-none",children:"ประเมินคุณภาพการบันทึกเวชระเบียนในภาพรวม"}),(0,t.jsxs)("div",{className:"flex items-start gap-2 py-2",children:[(0,t.jsx)("p",{className:"font-semibold w-[130px] text-sm",children:"Overall Finding"}),(0,t.jsx)("div",{className:"flex flex-col gap-2",children:F.length>0&&F.map((e,a)=>(0,t.jsx)(p.Checkbox,{size:"sm",value:e.overall_finding_result,defaultSelected:!!F&&e.overall_finding_result,onValueChange:t=>((e,t)=>{var a,l,r;let n=null!=(l=null==t||null==(a=t.overall_finding)?void 0:a.overall_finding_id)?l:null==t?void 0:t.overall_finding_id,i=null!=(r=null==t?void 0:t.form_ipd_overall_finding_result_id)?r:null;if(!n)return;let s=(null==t?void 0:t.overall_finding_result)===!0;Q(t=>{let a=[...t.overall],l=a.findIndex(e=>e.overall_finding_id===n);if(l>-1)if(e===s)a.splice(l,1);else{var r;a[l]={...a[l],overall_finding_result:e,form_ipd_overall_finding_result_id:null!=(r=a[l].form_ipd_overall_finding_result_id)?r:i}}else e!==s&&a.push({form_ipd_overall_finding_result_id:i,overall_finding_id:n,overall_finding_result:e});return{...t,overall:a}})})(t,e),label:"ไม่ต้องการบันทึก",radius:"full",children:e.overall_finding.overall_finding_name},a))})]}),(0,t.jsxs)("div",{className:"flex items-start gap-2 py-2 select-none",children:[(0,t.jsx)("p",{className:"font-semibold w-[130px] text-sm",children:"(เลือกเพียง 1 ข้อ)"}),(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)(h.RadioGroup,{onValueChange:e=>(e=>{let t=null==W?void 0:W.find(t=>t.review_status_id===e);Q(e=>({...e,review_status_id:t.review_status_id,review_status_result:!0,review_status_comment:t.review_status_comment}))})(e),children:(null==W?void 0:W.length)>0&&(null==W?void 0:W.map(e=>(0,t.jsxs)(x.Radio,{size:"sm",value:e.review_status_id,children:[e.review_status_name," (",e.review_status_description,")"]},e.review_status_id)))}),W&&(null==W||null==(e=W.find(e=>e.review_status_id===J.review_status_id))?void 0:e.review_status_type)===!0&&(0,t.jsx)(i.Input,{onValueChange:e=>Q(t=>({...t,review_status_comment:e})),variant:"bordered",labelPlacement:"outside",radius:"md",label:"อื่นๆ",placeholder:"อื่นๆ",value:J.review_status_comment})]})]})]}),er&&(""===L?(0,t.jsx)(m.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"z-50 fixed inset-0 w-full h-dvh flex items-center justify-center backdrop-blur-xs",children:(0,t.jsx)(l.default,{title:"กําลังสร้าง PDF..."})}):(0,t.jsx)("div",{className:"w-full h-[calc(100vh-15vh)] overflow-hidden rounded-2xl my-2 shadow-lg",children:(0,t.jsx)("iframe",{title:"pdf",loading:"lazy",width:"100%",height:"100%",src:"data:application/pdf;base64,".concat(L),className:"w-full h-full"})})),!er&&(0,t.jsx)(m.motion.button,{onClick:ev,className:"w-full mt-4 text-emerald-700 font-semibold py-2 bg-emerald-50 border border-emerald-700 dark:hover:bg-emerald-800 rounded-2xl dark:bg-emerald-700 dark:text-white cursor-pointer disabled:opacity-40 disabled:cursor-not-allowed",onMouseDown:e=>ec.create(e),disabled:ea||0===P.length||G||null==Z,children:ea?"กำลังบันทึกข้อมูล":"บันทึก"})]})}},75977,e=>{e.v(t=>Promise.all(["static/chunks/f56ebfa37fbe636f.js"].map(t=>e.l(t))).then(()=>t(40588)))}]);